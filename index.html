<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Clam by delectable-press</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Clam</h1>
        <h2>Truly dockerized WordPress</h2>
        <a href="https://github.com/delectable-press/clam" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="a-truly-dockerized-wordpress" class="anchor" href="#a-truly-dockerized-wordpress" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>A truly dockerized WordPress</h1>

<p><a href="http://home.withinboredom.info:8090/delectable-press/clam"><img src="http://home.withinboredom.info:8090/api/badges/delectable-press/clam/status.svg" alt="Build Status"></a></p>

<p>The goal is to make wordpress hyper-scalable for production use in Docker. There's still work to do; please feel free
to contribute in any way by opening an issue or a PR.</p>

<p><strong>I spend my day job on OSX and my night work on Windows, so this repo will remain OS agnostic.</strong> </p>

<h2>
<a id="how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How it works</h2>

<p>Each plugin is a docker container, built by the image in <code>images/composer</code>, allowing for some plugin isolation. You can
find examples of how to build them in <code>images/build.all</code>. Then WordPress itself is in another container, using the 
roots/bedrock plugins and folder structure. WordPress is a git subtree from <code>johnpbloch/wordpress</code>.</p>

<p>The database is served via <code>tutum/mysql</code> and includes replication out of the box. Using the hyperdb plugin from the
wordpress.com folks, reads come from the replicas and writes go to the master. Even if the master were to go down, the
replicas would still be serving clients.</p>

<p>Local development is done using <code>docker-compose</code> ...</p>

<p>To get started, simply clone this repo and edit any variables (such as WP_HOME, WP_SITEURL), then run <code>docker-compose up</code>.</p>

<p>It's designed to be run with docker swarm.</p>

<h2>
<a id="still-to-do" class="anchor" href="#still-to-do" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Still to do</h2>

<ul>
<li>plugins and hooks</li>
<li>automatic builds</li>
<li>documentation</li>
<li>other things I can't remember right now</li>
</ul>

<p>If you want to contribute, you have two options:</p>

<ol>
<li>Fork the repository and open a pull request</li>
<li>Open an issue with bugs you find or feedback</li>
</ol>

<h1>
<a id="getting-started-in-windows" class="anchor" href="#getting-started-in-windows" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started in Windows</h1>

<p>This will get you set up for development</p>

<ol>
<li>Get cmdr</li>
<li>Get docker toolbox</li>
</ol>

<h2>
<a id="running-it" class="anchor" href="#running-it" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running it</h2>

<div class="highlight highlight-source-powershell"><pre>.<span class="pl-k">/</span>stacks<span class="pl-k">/</span><span class="pl-c1">start-swarm.ps1</span>
docker<span class="pl-k">-</span>compose up</pre></div>

<h2>
<a id="building-from-source" class="anchor" href="#building-from-source" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Building from source</h2>

<div class="highlight highlight-source-powershell"><pre>.<span class="pl-k">/</span>stacks<span class="pl-k">/</span><span class="pl-c1">start-swarm.ps1</span>
docker build <span class="pl-k">-</span>t clamp<span class="pl-k">/</span>builder images
docker run <span class="pl-k">-</span>v <span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>run<span class="pl-k">/</span>docker.sock:<span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>run<span class="pl-k">/</span>docker.sock <span class="pl-k">-</span>v <span class="pl-k">/</span>c<span class="pl-k">/</span>Users<span class="pl-k">/</span>YourUserName<span class="pl-k">/</span>.docker<span class="pl-k">/</span>config.json:<span class="pl-k">/</span>root<span class="pl-k">/</span>.docker<span class="pl-k">/</span>config.json <span class="pl-k">--</span>rm clamp<span class="pl-k">/</span>builder <span class="pl-k">--</span>bases <span class="pl-k">--</span>libs <span class="pl-k">--</span>runs <span class="pl-k">--</span>services <span class="pl-k">--</span>plugins <span class="pl-k">--</span>themes <span class="pl-k">-</span><span class="pl-k">-cle</span>anup <span class="pl-k">--</span>seq
docker<span class="pl-k">-</span>compose up</pre></div>

<h1>
<a id="getting-started-in-osx" class="anchor" href="#getting-started-in-osx" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started in OSX</h1>

<p>This will get you set up for development</p>

<ol>
<li>get docker toolbox</li>
</ol>

<p>Bash:</p>

<div class="highlight highlight-source-shell"><pre>docker-machine create --driver virtualbox --virtualbox-memory=2048 --virtualbox-cpu-count=2 default
<span class="pl-c1">eval</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-s"><span class="pl-pds">$(</span>docker-machine env --shell bash default<span class="pl-pds">)</span></span><span class="pl-pds">"</span></span></pre></div>

<p>FiSH:</p>

<div class="highlight highlight-source-fish"><pre>docker-machine create <span class="pl-s">--driver</span> virtualbox <span class="pl-s">--virtualbox-memory</span>=20458 <span class="pl-s">--virtualbox-cpu-count</span>=2 default
<span class="pl-c1">eval</span> (docker-machine <span class="pl-c1">env</span> <span class="pl-s">--shell</span> fish default)</pre></div>

<h2>
<a id="running-it-1" class="anchor" href="#running-it-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running it</h2>

<div class="highlight highlight-source-shell"><pre>docker-compose up</pre></div>

<h2>
<a id="building-from-source-1" class="anchor" href="#building-from-source-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Building from source</h2>

<div class="highlight highlight-source-shell"><pre>docker build -t clamp/builder images
docker run -v /var/run/docker.sock:/var/run/docker.sock -v <span class="pl-k">~</span>/.docker/config.json:/root/.docker/config.json --rm clamp/builder --bases --libs --runs --services --plugins --themes --cleanup --seq
docker-compose up</pre></div>

<h1>
<a id="available-builder-options" class="anchor" href="#available-builder-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Available builder options</h1>

<ul>
<li>
<code>--bases</code>: Builds base images</li>
<li>
<code>--libs</code>: Builds all library containers</li>
<li>
<code>--runs</code>: Builds all runable containers that provide continuous services, like web servers.</li>
<li>
<code>--services</code>: Builds all infrastructure services, these are single run containers that usually are triggered by events</li>
<li>
<code>--plugins</code>: Builds a default set of plugins</li>
<li>
<code>--themes</code>: Builds a default set of themes</li>
<li>
<code>--cleanup</code>: Runs spotify/docker-gc and removes stale containers and images</li>
<li>
<code>--push</code>: Pushes the current version tag (What passes for a release right now)</li>
<li>
<code>--seq</code>: Runs builds sequentially instead of in parallel</li>
</ul>

<h1>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h1>

<p>While this is available to be read for free, I retain all copywrite. It's like a book in the library, you can borrow it,
but you can't steal it. Just kidding. It follows the WordPress license: GPLv2</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/delectable-press/clam/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/delectable-press/clam/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/delectable-press/clam"></a> is maintained by <a href="https://github.com/delectable-press">delectable-press</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
