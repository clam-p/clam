<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Clam by delectable-press</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Clam</h1>
      <h2 class="project-tagline">Truly dockerized WordPress</h2>
      <a href="https://github.com/delectable-press/clam" class="btn">View on GitHub</a>
      <a href="https://github.com/delectable-press/clam/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/delectable-press/clam/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="a-truly-dockerized-wordpress" class="anchor" href="#a-truly-dockerized-wordpress" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>A truly dockerized WordPress</h1>

<p>A lot of dockerized WordPresses out there clash with the "docker way". This is an attempt to set the record straight and
get a nicely done dockerized WordPress off the ground. There's still a long way to, but it will get there, one step at 
a time. <em>This is nowhere near production ready</em></p>

<p><strong>I spend my day job on OSX and my night work on Windows, so this repo will remain OS agnostic.</strong> </p>

<h2>
<a id="how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How it works</h2>

<p>Each plugin is a docker container, built by the image in <code>images/composer</code>, allowing for some plugin isolation. You can
find examples of how to build them in <code>images/build.all</code>. Then WordPress itself is in another container, using the 
roots/bedrock plugins and folder structure. WordPress is a git subtree from <code>johnpbloch/wordpress</code>.</p>

<p>The database is served via <code>tutum/mysql</code> and includes replication out of the box. Using the hyperdb plugin from the
wordpress.com folks, reads come from the replicas and writes go to the master. Even if the master were to go down, the
replicas would still be serving clients.</p>

<p>Local development is done using <code>docker-compose</code> ...</p>

<h2>
<a id="still-to-do" class="anchor" href="#still-to-do" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Still to do</h2>

<ul>
<li><del>memcached</del></li>
<li>varnish</li>
<li>uploads</li>
<li>plugins and hooks</li>
<li>automatic builds</li>
<li>documentation</li>
<li>other things I can't remember right now</li>
</ul>

<p>If you want to contribute, you have two options:</p>

<ol>
<li>Fork the repository and open a pull request</li>
<li>Open an issue with bugs you find or feedback</li>
</ol>

<h1>
<a id="getting-started-in-windows" class="anchor" href="#getting-started-in-windows" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started in Windows</h1>

<p>This will get you set up for development</p>

<ol>
<li>Get cmdr</li>
<li>Get docker toolbox</li>
</ol>

<h2>
<a id="running-it" class="anchor" href="#running-it" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running it</h2>

<div class="highlight highlight-source-powershell"><pre>docker<span class="pl-k">-</span>machine create <span class="pl-k">--</span>driver virtualbox <span class="pl-k">--</span>virtualbox<span class="pl-k">-</span>memory<span class="pl-k">=</span><span class="pl-c1"><span class="pl-c1">2048</span></span> <span class="pl-k">--</span>virtualbox<span class="pl-k">-</span>cpu<span class="pl-k">-</span>count<span class="pl-k">=</span><span class="pl-c1"><span class="pl-c1">2</span></span> default
<span class="pl-c1">docker-machine.exe</span> env <span class="pl-k">--</span>shell powershell default <span class="pl-k">|</span> <span class="pl-c1">Invoke-Expression</span>
docker<span class="pl-k">-</span>compose up</pre></div>

<h2>
<a id="building-from-source" class="anchor" href="#building-from-source" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Building from source</h2>

<div class="highlight highlight-source-powershell"><pre>docker<span class="pl-k">-</span>machine create <span class="pl-k">--</span>driver virtualbox <span class="pl-k">--</span>virtualbox<span class="pl-k">-</span>memory<span class="pl-k">=</span><span class="pl-c1"><span class="pl-c1">2048</span></span> <span class="pl-k">--</span>virtualbox<span class="pl-k">-</span>cpu<span class="pl-k">-</span>count<span class="pl-k">=</span><span class="pl-c1"><span class="pl-c1">2</span></span> default
<span class="pl-c1">docker-machine.exe</span> env <span class="pl-k">--</span>shell powershell default <span class="pl-k">|</span> <span class="pl-c1">Invoke-Expression</span>
docker build <span class="pl-k">-</span>t clamp<span class="pl-k">/</span>builder images
docker run <span class="pl-k">-</span>v <span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>run<span class="pl-k">/</span>docker.sock:<span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>run<span class="pl-k">/</span>docker.sock <span class="pl-k">-</span>v <span class="pl-k">/</span>c<span class="pl-k">/</span>Users<span class="pl-k">/</span>withi<span class="pl-k">/</span>.docker<span class="pl-k">/</span>config.json:<span class="pl-k">/</span>root<span class="pl-k">/</span>.docker<span class="pl-k">/</span>config.json <span class="pl-k">--</span>rm clamp<span class="pl-k">/</span>builder <span class="pl-k">--</span>runs <span class="pl-k">--</span>plugins <span class="pl-k">-</span><span class="pl-k">-cle</span>anup
docker<span class="pl-k">-</span>compose up</pre></div>

<h1>
<a id="getting-started-in-osx" class="anchor" href="#getting-started-in-osx" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started in OSX</h1>

<p>This will get you set up for development</p>

<ol>
<li>get docker toolbox</li>
</ol>

<p>Bash:</p>

<div class="highlight highlight-source-shell"><pre>docker-machine create --driver virtualbox --virtualbox-memory=2048 --virtualbox-cpu-count=2 default
<span class="pl-c1">eval</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-s"><span class="pl-pds">$(</span>docker-machine env --shell bash default<span class="pl-pds">)</span></span><span class="pl-pds">"</span></span></pre></div>

<p>FiSH:</p>

<div class="highlight highlight-source-fish"><pre>docker-machine create <span class="pl-s">--driver</span> virtualbox <span class="pl-s">--virtualbox-memory</span>=20458 <span class="pl-s">--virtualbox-cpu-count</span>=2 default
<span class="pl-c1">eval</span> (docker-machine <span class="pl-c1">env</span> <span class="pl-s">--shell</span> fish default)</pre></div>

<h2>
<a id="running-it-1" class="anchor" href="#running-it-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running it</h2>

<div class="highlight highlight-source-shell"><pre>docker-compose up</pre></div>

<h2>
<a id="building-from-source-1" class="anchor" href="#building-from-source-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Building from source</h2>

<div class="highlight highlight-source-shell"><pre>docker build -t clamp/builder images
docker run -v /var/run/docker.sock:/var/run/docker.sock -v <span class="pl-k">~</span>/.docker/config.json:/root/.docker/config.json --rm clamp/builder  --cleanup
docker-compose up</pre></div>

<h1>
<a id="available-builder-options" class="anchor" href="#available-builder-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Available builder options</h1>

<ul>
<li>
<code>--libs</code>: Builds all library containers</li>
<li>
<code>--runs</code>: Builds all runable containers that provide continuous services, like web servers.</li>
<li>
<code>--services</code>: Builds all infrastructure services, these are single run containers that usually are triggered by events</li>
<li>
<code>--plugins</code>: Builds a default set of plugins</li>
<li>
<code>--cleanup</code>: Runs spotify/docker-gc and removes stale containers and images</li>
<li>
<code>--push</code>: Pushes the current version tag (What passes for a release right now)</li>
<li>
<code>--seq</code>: Runs builds sequentially instead of in parallel</li>
</ul>

<h1>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h1>

<p>While this is available to be read for free, I retain all copywrite. It's like a book in the library, you can borrow it,
but you can't steal it. Just kidding. It follows the WordPress license: GPLv2</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/delectable-press/clam">Clam</a> is maintained by <a href="https://github.com/delectable-press">delectable-press</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
