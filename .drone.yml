build:
  builder:
    image: clamp/builder:0.2.0
    pull: true
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/builder:latest images
  volume-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/lib-volume:latest images/lib/volume
  volume-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/lib-base:latest images/lib/base
  mysql-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/lib-mysql:latest images/lib/mysql
  volume-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/lib-php-7:latest images/lib/php-7
  consul-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/lib-consul-server:latest images/lib/consul-server
  mysql-run-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/run-mysql:latest images/run/mysql
  plugin-run-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/run-plugin:latest images/run/plugin
  wordpress-run-container:
    image: clamp/builder:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    commands:
      - docker build -t clamp/run-wordpress:latest images/run/wordpress
publish:
  docker:
    username: $$DUSER
    password: $$DPASS
    email: $$DEMAIL
    repo: clamp/builder
    tag: latest
    file: images/Dockerfile
clone:
  path: /build